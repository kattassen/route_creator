 <!DOCTYPE html>
<html>
<head>
<script src="http://maps.googleapis.com/maps/api/js"></script>
<script>
var myCenter=new google.maps.LatLng(59.364699,17.964180);
var activeMarker = null;
var markers = [];
    
function initialize()
{   
var mapProp = {
  center:myCenter,
  zoom:10,
  mapTypeId:google.maps.MapTypeId.ROADMAP
  };

var map=new google.maps.Map(document.getElementById("googleMap"),mapProp);
    
google.maps.event.addListener(map, 'click', function(event) {
   placeMarker(event.latLng);
});

var infowindow = new google.maps.InfoWindow({
    content: ""
});

function placeMarker(location) {
    var marker = new google.maps.Marker({
        position: location,
        draggable: true,
        map: map,
        title: "",
        text: "",
        ttsText: "",
        rad: 100,
    });
    marker.addListener('click', function() {
        infowindow.content = marker.title;
        infowindow.open(map, marker);
        document.getElementById("formName").value = marker.title;
        document.getElementById("formTts").value = marker.ttsText;
        document.getElementById("formInfo").value = marker.text;
        activeMarker = marker;
        showCoord(marker);
    });
    activeMarker = marker;
    markers.push(marker);
    showCoord(marker);
}
}

google.maps.event.addDomListener(window, 'load', initialize);

document.addEventListener('DOMContentLoaded', function() {
    document.getElementById("saveBtn").addEventListener('click',function () {
        if (activeMarker == null) {
            alert("No selected marker");    
        }
        else {
            activeMarker.title = document.getElementById("formName").value;
            activeMarker.text = document.getElementById("formInfo").value;
            activeMarker.ttsText = document.getElementById("formTts").value;
         }
    });
    
    document.getElementById("genBtn").addEventListener('click', function() {
        var rootXml = '<?xml version="1.0"?>\n';
        rootXml += '<route>\n';
        for (var i = 0; i < markers.length; i++) {
            rootXml += "<poi>\n";
            rootXml += xmlElem("id", "", i, 1);
            rootXml += xmlElem("name", "", markers[i].title, 1);
            rootXml += xmlElem("text", "", markers[i].text, 1);
            rootXml += xmlElem("tts", "", markers[i].ttsText, 1);
            var lat = markers[i].getPosition().lat();
            var lon = markers[i].getPosition().lng();
            var rad = markers[i].rad;
            rootXml += xmlElem("coord", "lat=" + lat + " lon=" + lon + " rad=" + rad, null, 1);
            rootXml += "</poi>\n";
        }
        rootXml += '</route>'
        alert(rootXml);
    });


});

function xmlElem(name, attributes, content, ind) {
    var xml;
    var divider = " ";
    var indent = ""
    if (attributes === null || attributes === "") {
        divider = "";
    }

    for (var i = 0; i < ind; i++) {
        indent += "\t";
    }
    if (content === null) {
        xml = indent + '<' + name + divider + attributes + '/>\n';
    } else {
        xml = indent + '<' + name + divider + attributes + '>' + content + '</' + name + '>\n';
    }
    return xml;
}

function showCoord(marker) {
    document.getElementById("lat").innerHTML = marker.getPosition().lat();
    document.getElementById("lon").innerHTML = marker.getPosition().lng();
    document.getElementById("rad").innerHTML = marker.rad;
}

</script>
</head>

<body>
    <div id="googleMap" style="width:100%;height:400px;"></div>

    <div id="inputForm">
        Name: <input type="text" name="Name" value="DADA" id="formName"><br>
        Info: <input type="text" name="Info" id="formInfo"><br>
        Text to speach: <input type="text" name="Tts" id="formTts"><br>
        <div class="coord">
            <div id="lat"></div>
            <div id="lon"></div>
            <div id="rad"></div>
        </div>
        <button id="saveBtn">Save</button>
        <button id="genBtn">Generate</button>
    </div>

</body>

</html> 