 <!DOCTYPE html>
<html>
<head>
<script src="http://maps.googleapis.com/maps/api/js"></script>
<script>
var myCenter=new google.maps.LatLng(59.364699,17.964180);
var activeMarker = null;
var markers = [];
    
function initialize()
{   
    var mapProp = {
        center:myCenter,
        zoom:10,
        mapTypeId:google.maps.MapTypeId.ROADMAP
    };

    var map=new google.maps.Map(document.getElementById("googleMap"),mapProp);

    google.maps.event.addListener(map, 'click', function(event) {
        placeMarker(event.latLng);
    });

    var infowindow = new google.maps.InfoWindow({
        content: ""
    });

    function placeMarker(location) {
        var marker = new google.maps.Marker({
            position: location,
            draggable: true,
            map: map,
            info: {
                title: "",
                text: "",
                ttsText: "",
                rad: 100},
        });
        marker.addListener('click', function() {
            infowindow.content = marker.info.title;
            infowindow.open(map, marker);
            markerSelect(marker);
        });
        markers.push(marker);
        markerSelect(marker);
    }
}

google.maps.event.addDomListener(window, 'load', initialize);

document.addEventListener('DOMContentLoaded', function() {
    document.getElementById("saveBtn").addEventListener('click',function () {
        if (activeMarker == null) {
            alert("No selected marker");    
        }
        else {
            activeMarker.info.title = document.getElementById("formName").value;
            activeMarker.info.text = document.getElementById("formInfo").value;
            activeMarker.info.ttsText = document.getElementById("formTts").value;
         }
    });
    
    document.getElementById("genBtn").addEventListener('click', function() {
        var rootXml = "";
        for (var i = 0; i < markers.length; i++) {
            rootXml += JSON.stringify(markers[i].info);
        }

        alert(rootXml);
    });
});

function xmlElem(name, attributes, content, ind) {
    var xml;
    var divider = " ";
    var indent = ""
    if (attributes === null || attributes === "") {
        divider = "";
    }

    for (var i = 0; i < ind; i++) {
        indent += "\t";
    }
    if (content === null) {
        xml = indent + '<' + name + divider + attributes + '/>\n';
    } else {
        xml = indent + '<' + name + divider + attributes + '>' + content + '</' + name + '>\n';
    }
    return xml;
}

function markerSelect(marker) {
    activeMarker = marker;
    document.getElementById("formName").value = marker.info.title;
    document.getElementById("formTts").value = marker.info.ttsText;
    document.getElementById("formInfo").value = marker.info.text;
    document.getElementById("lat").innerHTML = marker.getPosition().lat();
    document.getElementById("lon").innerHTML = marker.getPosition().lng();
    document.getElementById("rad").innerHTML = marker.info.rad;
}

</script>
</head>

<body>
    <div id="googleMap" style="width:100%;height:400px;"></div>

    <div id="inputForm">
        Name: <input type="text" name="Name" value="DADA" id="formName"><br>
        Info: <input type="text" name="Info" id="formInfo"><br>
        Text to speach: <input type="text" name="Tts" id="formTts"><br>
        <div class="coord">
            <div id="lat"></div>
            <div id="lon"></div>
            <div id="rad"></div>
        </div>
        <button id="saveBtn">Save</button>
        <button id="genBtn">Generate</button>
    </div>

</body>

</html> 